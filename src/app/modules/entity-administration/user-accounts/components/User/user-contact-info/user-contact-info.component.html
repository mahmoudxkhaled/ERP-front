<div class="card">
    <div class="flex justify-content-between align-items-center mb-4">
        <h2>Contact Information</h2>
        <p-button label="Cancel" icon="pi pi-times" class="p-button-text" (onClick)="cancel()" [disabled]="loading">
        </p-button>
    </div>

    <form [formGroup]="form" (ngSubmit)="submit()" *ngIf="!loading">
        <div class="grid">
            <div class="col-12">
                <p-panel header="Contact Details" class="h-full">
                    <div class="grid">
                        <!-- Address -->
                        <div class="col-12">
                            <div class="field">
                                <label for="address" class="block text-sm font-medium mb-2">
                                    Address
                                </label>
                                <textarea id="address" pInputTextarea formControlName="address" rows="3"
                                    placeholder="Enter address" class="w-full"
                                    [ngClass]="{'ng-invalid ng-dirty': f['address']?.invalid && f['address']?.touched}">
                                </textarea>
                            </div>
                        </div>

                        <!-- Phone Numbers -->
                        <div class="col-12">
                            <div class="field">
                                <div class="flex justify-content-between align-items-center mb-2">
                                    <label class="block text-sm font-medium">
                                        Phone Numbers
                                    </label>
                                    <p-button label="Add Phone" icon="pi pi-plus" size="small" 
                                        (onClick)="addPhoneNumber()" type="button"></p-button>
                                </div>
                                <div formArrayName="phoneNumbers" class="flex flex-column gap-2">
                                    <div *ngFor="let phoneGroup of phoneNumbersFormArray.controls; let i = index" 
                                        [formGroupName]="i" class="flex align-items-center gap-2">
                                        <input type="text" pInputText formControlName="number" 
                                            placeholder="Enter phone number" class="flex-1"
                                            [ngClass]="{'ng-invalid ng-dirty': phoneGroup.get('number')?.invalid && phoneGroup.get('number')?.touched}" />
                                        <button pButton pRipple type="button" icon="pi pi-times" 
                                            class="p-button-rounded p-button-danger p-button-text"
                                            (click)="removePhoneNumber(i)" 
                                            [disabled]="phoneNumbersFormArray.length === 1">
                                        </button>
                                        <small class="p-error" *ngIf="submitted && getPhoneNumberError(i)">
                                            {{ getPhoneNumberError(i) }}
                                        </small>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Social Media Links -->
                        <div class="col-12 md:col-6">
                            <div class="field">
                                <label for="linkedinPage" class="block text-sm font-medium mb-2">
                                    LinkedIn Page
                                </label>
                                <input id="linkedinPage" type="url" pInputText formControlName="linkedinPage"
                                    placeholder="https://linkedin.com/in/..." class="w-full"
                                    [ngClass]="{'ng-invalid ng-dirty': f['linkedinPage']?.invalid && f['linkedinPage']?.touched}" />
                                <small class="p-error" *ngIf="submitted && getLinkedinError()">{{ getLinkedinError() }}</small>
                            </div>
                        </div>

                        <div class="col-12 md:col-6">
                            <div class="field">
                                <label for="facebookPage" class="block text-sm font-medium mb-2">
                                    Facebook Page
                                </label>
                                <input id="facebookPage" type="url" pInputText formControlName="facebookPage"
                                    placeholder="https://facebook.com/..." class="w-full"
                                    [ngClass]="{'ng-invalid ng-dirty': f['facebookPage']?.invalid && f['facebookPage']?.touched}" />
                                <small class="p-error" *ngIf="submitted && getFacebookError()">{{ getFacebookError() }}</small>
                            </div>
                        </div>

                        <div class="col-12 md:col-6">
                            <div class="field">
                                <label for="instagramPage" class="block text-sm font-medium mb-2">
                                    Instagram Page
                                </label>
                                <input id="instagramPage" type="url" pInputText formControlName="instagramPage"
                                    placeholder="https://instagram.com/..." class="w-full"
                                    [ngClass]="{'ng-invalid ng-dirty': f['instagramPage']?.invalid && f['instagramPage']?.touched}" />
                                <small class="p-error" *ngIf="submitted && getInstagramError()">{{ getInstagramError() }}</small>
                            </div>
                        </div>

                        <div class="col-12 md:col-6">
                            <div class="field">
                                <label for="twitterPage" class="block text-sm font-medium mb-2">
                                    Twitter Page
                                </label>
                                <input id="twitterPage" type="url" pInputText formControlName="twitterPage"
                                    placeholder="https://twitter.com/..." class="w-full"
                                    [ngClass]="{'ng-invalid ng-dirty': f['twitterPage']?.invalid && f['twitterPage']?.touched}" />
                                <small class="p-error" *ngIf="submitted && getTwitterError()">{{ getTwitterError() }}</small>
                            </div>
                        </div>
                    </div>
                </p-panel>
            </div>
        </div>

        <div class="flex justify-content-end gap-2 mt-4">
            <p-button label="Cancel" icon="pi pi-times" class="p-button-text" (onClick)="cancel()" [disabled]="loading">
            </p-button>
            <p-button label="Save" icon="pi pi-check" type="submit" [disabled]="loading">
                <ng-container *ngIf="loading">
                    <span class="indicator-progress" [style.display]="'block'">
                        Please wait
                        <i class="pi pi-spin pi-spinner" style="font-size: 1rem"></i>
                    </span>
                </ng-container>
            </p-button>
        </div>
    </form>

    <div *ngIf="loading" class="flex justify-content-center align-items-center" style="min-height: 200px;">
        <i class="pi pi-spin pi-spinner" style="font-size: 2rem"></i>
    </div>
</div>

<p-toast></p-toast>

