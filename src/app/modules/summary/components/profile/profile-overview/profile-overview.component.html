<div class="erp-profile-canvas card">
    <p-toast></p-toast>

    <div class="profile-top-bar flex justify-content-between align-items-end mb-5">
        <div class="identity-context">
            <span class="text-primary font-bold text-xs uppercase tracking-widest mb-2 block">{{ 'dashboard.profile' | translate }}</span>
            <h1 class="text-900 text-4xl font-extrabold m-0 tracking-tight">{{ getUserDisplayName() }}</h1>
        </div>
        <div class="actions">
            <p-button [label]="'layout.app-breadcrumb.editProfile' | translate" icon="pi pi-pencil"
                styleClass="p-button-secondary p-button-text font-bold" (onClick)="navigateToEdit()"></p-button>
        </div>
    </div>

    <div class="grid p-fluid">
        <div class="col-12 mb-4">
            <div
                class="identity-banner surface-card shadow-1 border-round-xl flex flex-column md:flex-row align-items-center p-5 gap-6">
                <div class="avatar-container relative">
                    <p-avatar [image]="profilePictureUrl || 'assets/media/avatar.png'" size="xlarge" shape="circle"
                        styleClass="border-4 border-white shadow-3" [style]="{'width': '150px', 'height': '150px'}">
                    </p-avatar>
                    <div class="status-ring"
                        [style.background]="getStatusSeverity() === 'success' ? '#10b981' : '#f59e0b'"></div>
                </div>

                <div class="identity-info flex-1">
                    <div class="flex align-items-center gap-3 mb-4">
                        <p-tag [value]="getStatusLabel()" [severity]="getStatusSeverity()"
                            styleClass="text-xs font-bold uppercase px-3"></p-tag>
                        <span class="text-500 font-mono text-sm">UID: {{ userDetails?.User_ID }}</span>
                    </div>

                    <div class="grid">
                        <div class="col-12 md:col-6">
                            <span class="text-500 text-xs font-bold uppercase block mb-1">{{ 'profile.labels.emailAddress' | translate }}</span>
                            <span class="text-900 font-bold text-lg">{{ accountDetails?.Email || '—' }}</span>
                        </div>
                        <div class="col-12 md:col-6">
                            <span class="text-500 text-xs font-bold uppercase block mb-1">{{ 'profile.labels.company' | translate }}</span>
                            <span class="text-900 font-bold text-lg">{{ isRegional ? (entityDetails?.Name_Regional ||
                                entityDetails?.Name || '') : (entityDetails?.Name || '—') }}</span>
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <div class="col-12 lg:col-8">
            <div class="surface-card p-5 border-round-xl shadow-1 h-full">
                <h3 class="text-900 font-bold text-xl mb-4 flex align-items-center gap-2">
                    <i class="pi pi-id-card text-primary"></i> {{ 'profile.personalInfo' | translate }}
                </h3>
                <div class="grid">
                    <div class="col-12 md:col-6 mb-3">
                        <label class="font-bold text-sm text-600 block mb-2">{{ 'profile.overview.fullName' | translate }}</label>
                        <div class="p-3   border-round font-semibold text-900">
                            {{ getFirstName() }} {{ getMiddleName() }} {{ getLastName() }}
                        </div>
                    </div>
                    <div class="col-12 md:col-6 mb-3">
                        <label class="font-bold text-sm text-600 block mb-2">{{ 'profile.fields.gender' | translate }}</label>
                        <div class="p-3   border-round font-semibold text-900">
                            {{ getGenderLabel() }}
                        </div>
                    </div>
                    <div class="col-12 mt-2" *ngIf="accountDetails?.Description">
                        <label class="font-bold text-sm text-600 block mb-2">{{ 'profile.labels.account' | translate }}</label>
                        <div class="p-4   border-round line-height-3 text-700 italic border-left-3 border-primary">
                            "{{ accountDetails?.Description }}"
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-12 lg:col-4">
            <div class="surface-card p-5 border-round-xl shadow-1 mb-4">
                <h3 class="text-900 font-bold text-lg mb-4">{{ 'profile.overview.contactInformation' | translate }}</h3>
                <div class="flex flex-column gap-4">
                    <div class="flex align-items-start gap-3" *ngIf="userContactInfo && userContactInfo.address">
                        <i class="pi pi-map-marker text-primary mt-1"></i>
                        <div>
                            <span class="text-xs text-500 font-bold uppercase block">{{ 'profile.overview.address' | translate }}</span>
                            <span class="text-900 font-medium">{{ userContactInfo.address }}</span>
                        </div>
                    </div>
                    <div class="flex align-items-start gap-3"
                        *ngIf="userContactInfo && userContactInfo.phoneNumbers && userContactInfo.phoneNumbers.length > 0">
                        <i class="pi pi-phone text-primary mt-1"></i>
                        <div class="flex-1">
                            <span class="text-xs text-500 font-bold uppercase block mb-2">{{ 'profile.fields.phone' | translate }}</span>
                            <ul class="list-none p-0 m-0 flex flex-column gap-2">
                                <li *ngFor="let phone of userContactInfo.phoneNumbers" class="text-900 font-medium">
                                    {{ phone }}
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div *ngIf="!userContactInfo || (!userContactInfo?.address && (!userContactInfo?.phoneNumbers || userContactInfo.phoneNumbers.length === 0))"
                        class="text-center text-500 p-3">
                        {{ 'profile.overview.noContactInfoAvailable' | translate }}
                    </div>
                </div>
            </div>

            <div class="surface-card p-5 border-round-xl shadow-1"
                *ngIf="userContactInfo && (userContactInfo.linkedinPage || userContactInfo.facebookPage || userContactInfo.instagramPage || userContactInfo.twitterPage)">
                <h3 class="text-900 font-bold text-lg mb-4">{{ 'profile.overview.socialMedia' | translate }}</h3>
                <div class="flex gap-2">
                    <p-button *ngIf="userContactInfo?.linkedinPage" icon="pi pi-linkedin"
                        [pTooltip]="userContactInfo.linkedinPage" tooltipPosition="top"
                        styleClass="p-button-rounded p-button-text"
                        (onClick)="openSocialLink(userContactInfo.linkedinPage)"></p-button>
                    <p-button *ngIf="userContactInfo?.facebookPage" icon="pi pi-facebook"
                        [pTooltip]="userContactInfo.facebookPage" tooltipPosition="top"
                        styleClass="p-button-rounded p-button-text"
                        (onClick)="openSocialLink(userContactInfo.facebookPage)"></p-button>
                    <p-button *ngIf="userContactInfo?.instagramPage" icon="pi pi-instagram"
                        [pTooltip]="userContactInfo.instagramPage" tooltipPosition="top"
                        styleClass="p-button-rounded p-button-text"
                        (onClick)="openSocialLink(userContactInfo.instagramPage)"></p-button>
                    <p-button *ngIf="userContactInfo?.twitterPage" icon="pi pi-twitter"
                        [pTooltip]="userContactInfo.twitterPage" tooltipPosition="top"
                        styleClass="p-button-rounded p-button-text"
                        (onClick)="openSocialLink(userContactInfo.twitterPage)"></p-button>
                </div>
            </div>
        </div>
    </div>
</div>